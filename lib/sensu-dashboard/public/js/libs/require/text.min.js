define(["module"],function(a){"use strict";var b,c,d=["Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.4.0"],e=/^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im,f=/<body[^>]*>\s*([\s\S]+)\s*<\/body>/im,g=typeof location!=="undefined"&&location.href,h=g&&location.protocol&&location.protocol.replace(/\:/,""),i=g&&location.hostname,j=g&&(location.port||undefined),k=[],l=a.config&&a.config()||{};b={version:"2.0.3",strip:function(a){if(a){a=a.replace(e,"");var b=a.match(f);if(b){a=b[1]}}else{a=""}return a},jsEscape:function(a){return a.replace(/(['\\])/g,"\\$1").replace(/[\f]/g,"\\f").replace(/[\b]/g,"\\b").replace(/[\n]/g,"\\n").replace(/[\t]/g,"\\t").replace(/[\r]/g,"\\r").replace(/[\u2028]/g,"\\u2028").replace(/[\u2029]/g,"\\u2029")},createXhr:l.createXhr||function(){var a,b,c;if(typeof XMLHttpRequest!=="undefined"){return new XMLHttpRequest}else if(typeof ActiveXObject!=="undefined"){for(b=0;b<3;b+=1){c=d[b];try{a=new ActiveXObject(c)}catch(e){}if(a){d=[c];break}}}return a},parseName:function(a){var b=false,c=a.indexOf("."),d=a.substring(0,c),e=a.substring(c+1,a.length);c=e.indexOf("!");if(c!==-1){b=e.substring(c+1,e.length);b=b==="strip";e=e.substring(0,c)}return{moduleName:d,ext:e,strip:b}},xdRegExp:/^((\w+)\:)?\/\/([^\/\\]+)/,useXhr:function(a,c,d,e){var f,g,h,i=b.xdRegExp.exec(a);if(!i){return true}f=i[2];g=i[3];g=g.split(":");h=g[1];g=g[0];return(!f||f===c)&&(!g||g.toLowerCase()===d.toLowerCase())&&(!h&&!g||h===e)},finishLoad:function(a,c,d,e){d=c?b.strip(d):d;if(l.isBuild){k[a]=d}e(d)},load:function(a,c,d,e){if(e.isBuild&&!e.inlineText){d();return}l.isBuild=e.isBuild;var f=b.parseName(a),k=f.moduleName+"."+f.ext,m=c.toUrl(k),n=l.useXhr||b.useXhr;if(!g||n(m,h,i,j)){b.get(m,function(c){b.finishLoad(a,f.strip,c,d)},function(a){if(d.error){d.error(a)}})}else{c([k],function(a){b.finishLoad(f.moduleName+"."+f.ext,f.strip,a,d)})}},write:function(a,c,d,e){if(k.hasOwnProperty(c)){var f=b.jsEscape(k[c]);d.asModule(a+"!"+c,"define(function () { return '"+f+"';});\n")}},writeFile:function(a,c,d,e,f){var g=b.parseName(c),h=g.moduleName+"."+g.ext,i=d.toUrl(g.moduleName+"."+g.ext)+".js";b.load(h,d,function(c){var d=function(a){return e(i,a)};d.asModule=function(a,b){return e.asModule(a,i,b)};b.write(a,h,d,f)},f)}};if(l.env==="node"||!l.env&&typeof process!=="undefined"&&process.versions&&!!process.versions.node){c=require.nodeRequire("fs");b.get=function(a,b){var d=c.readFileSync(a,"utf8");if(d.indexOf("ï»¿")===0){d=d.substring(1)}b(d)}}else if(l.env==="xhr"||!l.env&&b.createXhr()){b.get=function(a,c,d){var e=b.createXhr();e.open("GET",a,true);if(l.onXhr){l.onXhr(e,a)}e.onreadystatechange=function(b){var f,g;if(e.readyState===4){f=e.status;if(f>399&&f<600){g=new Error(a+" HTTP status: "+f);g.xhr=e;d(g)}else{c(e.responseText)}}};e.send(null)}}else if(l.env==="rhino"||!l.env&&typeof Packages!=="undefined"&&typeof java!=="undefined"){b.get=function(a,b){var c,d,e="utf-8",f=new java.io.File(a),g=java.lang.System.getProperty("line.separator"),h=new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(f),e)),i="";try{c=new java.lang.StringBuffer;d=h.readLine();if(d&&d.length()&&d.charAt(0)===65279){d=d.substring(1)}c.append(d);while((d=h.readLine())!==null){c.append(g);c.append(d)}i=String(c.toString())}finally{h.close()}b(i)}}return b})
